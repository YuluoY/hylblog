/*!
 * docsify-valine
 * v1.0.4
 * https://github.com/daidi/docsify-valine#readme
 * (c) 2019-2020 daidi
 * MIT license
 */
function docsifyValine(hook, vm) {

    hook.ready(function () {
        if (!window.Valine) {
            console.warn('please include `<script src=\'//unpkg.com/valine/dist/Valine.min.js\'></script>` before init $docsify');
        }
    });

    hook.mounted(function () {
        var a = Docsify.dom;
        var n = a.create("div");
        n.id = "vcomments";
        var i = a.getNode("#main");
        // n.style = "width: " + i.clientWidth + "px !important; margin: 0 auto 20px;", a.appendTo(a.find(".content"), n);
        n.style = "max-width: 80% !important; margin: 0 auto 20px;";
        `<span id="<Your/Path/Name>" class="leancloud_visitors" data-flag-title="Your Article Title">
            <em class="post-meta-item-text">阅读量 </em>
            <i class="leancloud-visitors-count">1000000</i>
        </span>`
        var span = a.create('span');
        span.className = 'leancloud_visitors';
        let pathArr = location.href.split('/');
        span['data-flag-title'] = pathArr[pathArr.length - 1]
        span.innerHTML = `<em class="post-meta-item-text">阅读量 </em>
                        <i class="leancloud-visitors-count">1000000</i>`;
        a.appendTo(a.find(".content"), n);// responsive design
        // a.appendTo(a.find('.content'), span);

    })

    hook.doneEach(function () {
        vm.config.Valine = vm.config.Valine || {}
        var options = Object.assign({
            el: '#vcomments',
            path: vm.config.Valine.docPath === 'full' ? location.pathname + location.hash.replace(/\?.+/, "") : location.hash.replace(/\?.+/, ""),
        }, vm.config.Valine)

        if (!options.appId || !options.appKey) {
            console.warn('sorry , appId and appKey must be required .');
            return
        }
        new Valine(options)
    })
}

window.$docsify = window.$docsify || {};
window.$docsify.plugins = [docsifyValine].concat(window.$docsify.plugins || []);